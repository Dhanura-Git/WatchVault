<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-form-product-3.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:32 GMT -->

<head>
    <meta charset="utf-8">
    <title>WatchVault Edit Product</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <!-- <link rel="shortcut icon" type="image/x-icon" href="adminAssets/imgs/theme/favicon.svg"> -->
    <!-- Template CSS -->
    <link href="adminAssets/css/main.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="screen-overlay"></div>
    <%- include('./partials/adminAside.ejs') %>
        <main class="main-wrap">
            <%- include('./partials/adminHeader.ejs') %>
                <section class="content-main">
                    <form action="/admin/editProduct" method="post" id="editProductForm" enctype="multipart/form-data">
                        <div class="row">
                            <div class="col-9">
                                <div class="content-header">
                                    <h2 class="content-title">Edit Product</h2>
                                    <div>
                                        <button type="submit"
                                            class="btn btn-light rounded font-sm mr-5 text-body hover-up">Update</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <div class="mb-4">
                                            <label for="product_title" class="form-label">Product title</label>
                                            <input type="text" name="productName" value="<%= products.productName %>"
                                                placeholder="Type here" class="form-control" id="product_title">
                                            <div id="productNameError" class="text-danger"></div>
                                        </div>
                                        <div class="mb-4">
                                            <label for="product_brand" class="form-label">Brand</label>
                                            <input type="text" name="brand" value="<%= products.brand %>"
                                                placeholder="Type here" class="form-control" id="product_brand">
                                            <div id="brandError" class="text-danger"></div>
                                        </div>
                                    </div>
                                </div> <!-- card end// -->
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <div>
                                            <label class="form-label">Description</label>
                                            <input type="text" name="description" value="<%= products.description %>"
                                                placeholder="Type here" class="form-control" rows="4" id="description">
                                            <div id="descriptionError" class="text-danger"></div>
                                        </div>
                                    </div>
                                </div> <!-- card end// -->
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <div>
                                            <label class="form-label">Images</label>
                                            <input class="form-control" name="images" type="file" multiple
                                                onchange="previewImages(event)">
                                            <div id="image-preview-container" style="margin-top: 10px;">
                                                <!-- Current images -->
                                                <% for(let i=0; i<products.images.length; i++){ %>
                                                    <img src="/public/uploads/<%= products.images[i] %>"
                                                        style="max-width: 150px; margin-right: 10px; margin-bottom: 10px;">
                                                    <% } %>
                                            </div>
                                            <div id="imagesError" class="text-danger"></div>
                                        </div>
                                    </div>
                                </div> <!-- card end// -->
                            </div>
                            <div class="col-lg-3">
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <div class="mb-4">
                                            <label class="form-label">Price</label>
                                            <input type="text" name="price" value="<%= products.price %>"
                                                placeholder="Type here" class="form-control" id="price">
                                            <div id="priceError" class="text-danger"></div>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Stock</label>
                                            <input type="text" name="stock" value="<%= products.stock %>"
                                                placeholder="Type here" class="form-control" id="stock">
                                            <div id="stockError" class="text-danger"></div>
                                        </div>
                                        <hr>
                                        <label class="form-label">Categories</label>
                                        <select class="form-check" name="category" id="category">
                                            <% for(let i=0; i < cate.length; i++) { %>
                                                <option value="<%= cate[i]._id %>" <%=cate[i]._id==products.category
                                                    ? 'selected' : '' %>>
                                                    <%= cate[i].categoryName %>
                                                </option>
                                                <% } %>
                                        </select>
                                        <hr>
                                        <label class="form-label">Offers</label>
                                        <select class="form-check" name="offer" id="offer">
                                            <% for(let i=0; i < offers.length; i++) { %>
                                                <option value="<%= offers[i]._id %>" <%=offers[i]._id==products.offer
                                                    ? 'selected' : '' %>>
                                                    <%= offers[i].offerName %>
                                                </option>
                                                <% } %>
                                        </select>
                                        <div id="categoryError" class="text-danger"></div>
                                    </div>
                                </div> <!-- card end// -->
                            </div>
                        </div>
                    </form>
                </section>
                <footer class="main-footer font-xs">
                </footer>
        </main>

        <script>
            function imageValidation(input) {
                const extnAllowed = /(\.jpg|\.jpeg|\.png|\.webp)$/i;
                const files = input.files;
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    if (!extnAllowed.test(file.name)) {
                        toastr.error('Please select JPG, JPEG, PNG, WEBP image files only');
                        input.value = '';
                        return false;
                    }
                }
                return true;
            }

            function previewImages(event) {
                const files = event.target.files;
                const previewContainer = document.getElementById('image-preview-container');
                previewContainer.innerHTML = '';

                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    if (file.type.match('image.*')) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.style.maxWidth = '150px';
                            img.style.marginRight = '10px';
                            img.style.marginBottom = '10px';
                            previewContainer.appendChild(img);
                        }
                        reader.readAsDataURL(file);
                    } else {
                        toastr.error('Please select valid image files.');
                        event.target.value = ''; // Clear the input if invalid files are selected
                        return;
                    }
                }
            }

            document.getElementById('editProductForm').addEventListener('submit', function (event) {
                let isValid = true;

                // Clear previous error messages
                const errorElements = document.querySelectorAll('.text-danger');
                errorElements.forEach(element => {
                    element.textContent = '';
                });

                // Function to remove error messages after 5 seconds
                function removeErrorMessages() {
                    setTimeout(() => {
                        errorElements.forEach(element => {
                            element.textContent = '';
                        });
                    }, 5000);
                }

                // Validate product title
                const productName = document.getElementById('product_title');
                if (productName.value.trim() === "") {
                    isValid = false;
                    document.getElementById('productNameError').textContent = 'Product title cannot be empty.';
                } else if (productName.value.trim().length < 3) {
                    isValid = false;
                    document.getElementById('productNameError').textContent = 'Product title must be at least 3 characters long.';
                }

                // Validate brand
                const brand = document.getElementById('product_brand');
                if (brand.value.trim() === "") {
                    isValid = false;
                    document.getElementById('brandError').textContent = 'Brand cannot be empty.';
                }

                // Validate description
                const description = document.getElementById('description');
                if (description.value.trim() === "") {
                    isValid = false;
                    document.getElementById('descriptionError').textContent = 'Description cannot be empty.';
                } else if (description.value.trim().length < 10) {
                    isValid = false;
                    document.getElementById('descriptionError').textContent = 'Description must be at least 10 characters long.';
                }

                // Validate images
                // const images = document.querySelector('input[name="images"]');
                // const files = images.files;
                // const extnAllowed = /(\.jpg|\.jpeg|\.png|\.webp)$/i;
                // if (files.length <= 0) {
                //     isValid = false;
                //     document.getElementById('imagesError').textContent = 'At least one image must be uploaded.';
                // } else {
                //     for (let i = 0; i < files.length; i++) {
                //         const file = files[i];
                //         if (!extnAllowed.test(file.name)) {
                //             isValid = false;
                //             document.getElementById('imagesError').textContent = 'Please select JPG, JPEG, PNG, WEBP image files only.';
                //             break;
                //         }
                //     }
                // }

                // Validate price
                const price = document.getElementById('price');
                if (price.value.trim() === "") {
                    isValid = false;
                    document.getElementById('priceError').textContent = 'Price cannot be empty.';
                } else if (isNaN(price.value) || price.value <= 0) {
                    isValid = false;
                    document.getElementById('priceError').textContent = 'Price must be a positive number.';
                }

                // Validate stock
                const stock = document.getElementById('stock');
                if (stock.value.trim() === "") {
                    isValid = false;
                    document.getElementById('stockError').textContent = 'Stock cannot be empty.';
                } else if (isNaN(stock.value) || stock.value < 0) {
                    isValid = false;
                    document.getElementById('stockError').textContent = 'Stock must be a non-negative number.';
                }

                // Validate category
                const category = document.getElementById('category');
                if (category.value.trim() === "") {
                    isValid = false;
                    document.getElementById('categoryError').textContent = 'Category must be selected.';
                }

                if (!isValid) {
                    event.preventDefault(); // Prevent form submission if validation fails
                    removeErrorMessages(); // Remove error messages after 5 seconds
                }
            });
        </script>

        <script src="adminAssets/js/vendors/jquery-3.6.0.min.js"></script>
        <script src="adminAssets/js/vendors/bootstrap.bundle.min.js"></script>
        <script src="adminAssets/js/vendors/select2.min.js"></script>
        <script src="adminAssets/js/vendors/perfect-scrollbar.js"></script>
        <script src="adminAssets/js/vendors/jquery.fullscreen.min.js"></script>
        <!-- Main Script -->
        <script src="adminAssets/js/main.js" type="text/javascript"></script>
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-form-product-3.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:32 GMT -->

</html>